<!doctype html>
<html>
<head>
  <title>Cartographie de la complosphère française</title>
  <meta charset="utf-8">
  <link href="/complosphere/assets/sourcesanspro.css" rel="stylesheet" type="text/css" />
  <link href="/complosphere/assets/styles.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href="/complosphere/font-awesome-4.1.0/css/font-awesome.min.css">
  <style type="text/css" media="screen">
  html, body {
    font: 24px/150% "Source Sans Pro", sans-serif;
    background-image: url("/complosphere/assets/background.jpg");
    color: #fff;
    margin: 0;
    padding:0;
    width: 100%;
    height: 100%;
    font-size: 12px;
  }
  </style>
  <!--[if lt IE 8]>
    <link rel="stylesheet" href="/assets/stylesheets/social_foundicons_ie7.css">
  <![endif]-->
</head>
<body>

<div id="sigma-container">
  <div id="controls" class="bg">
    <h1>La complosphère française</h1>    
<!----    <h2><a target='_blank' href='http://parltrack.euwiki.org/committee/CULT' title='Go to Parltrack committee page (new window)'>Culture and Education</a></h2> 

    <p>
      Committee&nbsp;&nbsp;
      <a href="?co=AFCO" title='Constitutional Affairs' class=''>AFCO</a>&nbsp;&nbsp;
      <a href="?co=AFET" title='Foreign Affairs'  class=''>AFET</a>&nbsp;&nbsp;
      <a href="?co=AGRI" title='Agriculture and Rural Development'  class=''>AGRI</a>&nbsp;&nbsp;
      <a href="?co=BUDG" title='Budgets'  class=''>BUDG</a>&nbsp;&nbsp;
      <a href="?co=CONT" title='Budgetary Control'  class=''>CONT</a>&nbsp;&nbsp;
      <a href="?co=CRIM" title='Organised crime, corruption and money laundering'  class=''>CRIM</a>&nbsp;&nbsp;
      <a href="?co=CRIS" title='Financial, Economic and Social Crisis'  class=''>CRIS</a>&nbsp;&nbsp;
      <a href="?co=CULT" title='Culture and Education'  class='here'>CULT</a>&nbsp;&nbsp;
      <a href="?co=DEVE" title='Development'  class=''>DEVE</a>&nbsp;&nbsp;
      <a href="?co=DROI" title='Human Rights'  class=''>DROI</a>&nbsp;&nbsp;
      <a href="?co=ECON" title='Economic and Monetary Affairs'  class=''>ECON</a>&nbsp;&nbsp;
      <a href="?co=EMPL" title='Employment and Social Affairs'  class=''>EMPL</a>&nbsp;&nbsp;
      <a href="?co=ENVI" title='Environment, Public Health and Food Safety'  class=''>ENVI</a>&nbsp;&nbsp;
      <a href="?co=FEMM" title='Women's Rights and Gender Equality'  class=''>FEMM</a>&nbsp;&nbsp;
      <a href="?co=IMCO" title='Internal Market and Consumer Protection'  class=''>IMCO</a>&nbsp;&nbsp;
      <a href="?co=INTA" title='International Trade'  class=''>INTA</a>&nbsp;&nbsp;
      <a href="?co=ITRE" title='Industry, Research and Energy'  class=''>ITRE</a>&nbsp;&nbsp;
      <a href="?co=JURI" title='Legal Affairs'  class=''>JURI</a>&nbsp;&nbsp;
      <a href="?co=LIBE" title='Civil Liberties, Justice and Home Affairs'  class=''>LIBE</a>&nbsp;&nbsp;
      <a href="?co=PECH" title='Fisheries'  class=''>PECH</a>&nbsp;&nbsp;
      <a href="?co=PETI" title='Petitions'  class=''>PETI</a>&nbsp;&nbsp;
      <a href="?co=REGI" title='Regional Development'  class=''>REGI</a>&nbsp;&nbsp;
      <a href="?co=SEDE" title='Security and Defence'  class=''>SEDE</a>&nbsp;&nbsp;
      <a href="?co=SURE" title='Policy Challenges'  class=''>SURE</a>&nbsp;&nbsp;
      <a href="?co=TRAN" title='Transport and Tourism'  class=''>TRAN</a>
    </p>
--->
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
    <p>
      Cliquez sur un point pour montrer un sous-réseau. Double-cliquez pour (dé)zoomer.<br>
      Cacher&nbsp;
      <label title="Ne pas dessiner les liens.">
        <input type="checkbox" id="showEdges" />
        les liens
      </label>
      &nbsp;
      <label title="Ne pas ajouter d'étiquettes en zoomant.">
        <input type="checkbox" id="showLabels" />
        les étiquettes
      </label>
      &nbsp;
      <label title="Ne dessiner des liens que lorsque l'association est particulièrement forte.">
        <input type="checkbox" id="showSparse" checked />
        les liens faibles
      </label>
      <br>
<p></p>
<p><a href="https://twitter.com/intent/tweet?original_referer=https%3A%2F%2Fabout.twitter.com%2Ffr%2Fresources%2Fbuttons&text=La%20complosph%C3%A8re%20fran%C3%A7aise%2C&tw_p=tweetbutton&url=http%3A%2F%2Fwww.joelgombin.fr%2Fcomplosphere%2Fpage.html&via=joelgombin" class="button" title="Partager sur Twitter."><i class="fa fa-twitter"></i> Tweeter</a>&nbsp;&nbsp;<a href="https://github.com/joelgombin/complosphere" class="button" title="Récupérer le code et les données sur GitHub."><i class="fa fa-github"></i> Code</a></p>
    <footer>
        <p>Données collectées par les crawlers <a href="http://www.uberlink.com/services">VOSON</a> et <a href="http://www.medialab.sciences-po.fr/fr/tools/hyphe/">Hyphe</a>.<br />
          Photo de fond par <a href="https://www.flickr.com/photos/kt/97895608/in/photolist-5nJ9RX-4ZBKhb-65i1j-f71eHv-7P3Z1B-7dEYab-cweK7b-5SsokS-drvJN-mD8Fc-eeR1YL-9DJXj-a8Uvgi-5EprrJ-7RHcQ-3eTNzC-5SsbME-8P8Uzi-5BLrnP-crZvfw-aNhDFP-4QxQey-739QVh-cB2ZdA-5E8WCV-86tFtA-jqDQvt-fQ7ok2-5165Rj-dXUT1b-6etRv8-5Hjz4M-c8Bruq-bKpSmB-B8euZ-5BLrrF-59Xs7g-fBGaW-5iSJXf-511TwP-5166dq-huk5U-9KL31C-511TkD-7vHfMD-7vHfMT-fBL764-7c2V27-epteAg-rfP7w/">Kevin Trotman</a> (Flickr).</p>
    </footer>
    <div id="graph-container"></div>
  </div>
  <div id="caption" class="bg">
    <p>Ce graphique montre le réseau des sites de la complosphère française. Nous n'impliquons pas que chacun de ces sites diffuse des contenus conspirationnistes ; mais tous sont caractérisés par le fait qu'ils reçoivent et envoient des liens vers d'autres sites appartenant à la même sphère. Le choix des sites présentés n'est donc pas aléatoire, mais relève d'une logique algorithmique avec vérification humaine.</p><p>Ce travail a été réalisé par <a href="http://www.joelgombin.fr">Joël Gombin</a>, en partenariat avec <a href="http://www.conspiracywatch.info">Conspiracy Watch</a> et pour le compte de <a href="http://www.counterpoint.uk.com">Counterpoint</a>. </p>  </div>

</div>

<script src="/complosphere/sigmajs-release-v1.0.2/sigma.min.js"></script>
<script src="/complosphere/sigmajs-release-v1.0.2/plugins/sigma.parsers.gexf.min.js"></script>
<script src="/complosphere/sigmajs-release-v1.0.2/plugins/sigma.layout.forceAtlas2.min.js"></script>

<script>
function decimalAdjust(type, value, exp) {
    // If the exp is undefined or zero...
    if (typeof exp === 'undefined' || +exp === 0) {
        return Math[type](value);
    }
    value = +value;
    exp = +exp;
    // If the value is not a number or the exp is not an integer...
    if (isNaN(value) || !(typeof exp === 'number' && exp % 1 === 0)) {
        return NaN;
    }
    // Shift
    value = value.toString().split('e');
    value = Math[type](+(value[0] + 'e' + (value[1] ? (+value[1] - exp) : -exp)));
    // Shift back
    value = value.toString().split('e');
    return +(value[0] + 'e' + (value[1] ? (+value[1] + exp) : exp));
}

// Decimal round
if (!Math.round10) {
    Math.round10 = function(value, exp) {
        return decimalAdjust('round', value, exp);
    };
}

// Add a method to the graph model that returns an
// object with every neighbors of a node inside:
sigma.classes.graph.addMethod('neighbors', function(nodeId) {
  var k,
      neighbors = {},
      index = this.allNeighborsIndex[nodeId] || {};

  for (k in index)
    neighbors[k] = this.nodesIndex[k];

  return neighbors;
});

sigma.classes.graph.addMethod('getNeighborsCount', function(nodeId) {
  return this.allNeighborsCount[nodeId];
});

sigma.parsers.gexf(
  'reseau2.gexf',
  { // Here is the ID of the DOM element that
    // will contain the graph:
    container: 'sigma-container'
  },
  function(s) {
    
    console.log('reseau2.gexf')
      
    // We first need to save the original colors of our
    // nodes and edges, like this:
    s.graph.nodes().forEach(function(n) {
      n.originalColor = n.color;
      n.originalX = n.x;
      n.originalY = n.y;
    });
    s.graph.edges().forEach(function(e) {
      e.originalColor = e.color;
      e.type = 'arrow';
    });

    // When a node is clicked, we check for each node
    // if it is a neighbor of the clicked one. If not,
    // we set its color as grey, and else, it takes its
    // original color.
    // We do the same for the edges, and we only keep
    // edges that have both extremities colored.
    s.bind('clickNode', function(e) {
      var nodeId = e.data.node.id,
          toKeep = s.graph.neighbors(nodeId);
      toKeep[nodeId] = e.data.node;

      s.graph.nodes().forEach(function(n) {
        if (toKeep[n.id])
          n.color = '#E61616';
        else
          n.color = n.originalColor;
      });

      s.graph.edges().forEach(function(e) {
        if (toKeep[e.source] && toKeep[e.target])
          e.color = e.originalColor;
        else
          e.color = '#D8D8D8';
      });

      // node color
      var rgba = e.data.node.color;

      profile = "<a href='http://" + e.data.node.attributes['url'] + "' title='Voir le site (nouvelle fenêtre)' target='_blank'>";
      // parltrack = "<a href='http://parltrack.euwiki.org/mep/" + e.data.node.attributes['label'] + "' title='Go to Parltrack profile (new window)' target='_blank'";
      
      document.getElementById('caption').innerHTML =  profile + ' </a> <p>' + profile + e.data.node.attributes['url'] + '</a></p> <span style="color:' + rgba.replace('0.3)', '1)') + ';"></span><p>Thèmes : ' + e.data.node.attributes['themes'] + '</p><p>Description : ' + e.data.node.attributes['description'] + '</p><p>Ressources :' + e.data.node.attributes['ressources'] +  '</p><p><a href="http://' + e.data.node.attributes['url'] + '" class="button"" style="width: 125px; margin:1.25em 0; float:none;" title="Voir le site (nouvelle fenêtre)" target="_blank">Voir le site</a>&nbsp;&nbsp; </p>';
      
      // Since the data has been modified, we need to
      // call the refresh method to make the colors
      // update effective.
      s.refresh();
    });

    // When the stage is clicked, we just color each
    // node and edge with its original color.
    s.bind('clickStage', function(e) {
      s.graph.nodes().forEach(function(n) {
        n.color = n.originalColor;
      });

      s.graph.edges().forEach(function(e) {
        e.color = e.originalColor;
      });

      // Same as in the previous event:
      s.refresh();
      
      document.getElementById('caption').innerHTML = '<p>Ce graphique montre le réseau des sites de la complosphère française. Nous n\'impliquons pas que chacun de ces sites diffuse des contenus conspirationnistes ; mais tous sont caractérisés par le fait qu\'ils reçoivent et envoient des liens vers d\'autres sites appartenant à la même sphère. Le choix des sites présentés n\'est donc pas aléatoire, mais relève d\'une logique algorithmique avec vérification humaine.</p><p>Ce travail a été réalisé par <a href="http://www.joelgombin.fr">Joël Gombin</a>, en partenariat avec <a href="http://www.conspiracywatch.info">Conspiracy Watch</a> et pour le compte de <a href="http://www.counterpoint.uk.com">Counterpoint</a>. </p>';
    });
    
    s.settings({
      defaultEdgeColor: '#555',
      edgeColor: 'source',
      minNodeSize: 2,
      maxNodeSize: 6,
      defaultLabelColor: '#fff',
      defaultLabelSize: 18,
      font: "source sans pro",
      minEdgeSize: .3,
      maxEdgeSize: .9,
      labelHoverBGColor: 'node',
      defaultLabelHoverColor: '#fff',
      labelHoverShadow: 'node'
    });
    
    // Refresh the graph to see the changes:
    s.refresh();
    
    // hide edges
    //
    document.getElementById('showEdges').addEventListener('change',
    function(e){
      if (e.target.checked) {
        s.settings({
          drawEdges: false
        });
      } else {
        s.settings({
          drawEdges: true
        });
      }
      s.refresh();
    });
    
    // hide labels
    //
    document.getElementById('showLabels').addEventListener('change', 
    function(e){
      if (e.target.checked) {
        s.settings({
          drawLabels: false
        });
      } else {
        s.settings({
          drawLabels: true
        });
      }
      s.refresh();
    }); 
    
    // hide sparse ties
    //
    document.getElementById('showSparse').addEventListener('change', 
    function(e){
      if (e.target.checked) {
        s.graph.edges().forEach(function(e) {
          // use upper quartile marker
          if(e.weight > 1)
            e.color = 'rgba(66,66,66,0)';
        });
        s.settings({
          minEdgeSize: .1,
          maxEdgeSize: 3
        });
      } else {
        s.graph.edges().forEach(function(e) {
          e.color = e.originalColor;
        });
        s.settings({
          minEdgeSize: .5,
          maxEdgeSize: 1,
        });
      }
      s.refresh();
    }); 
        
    // force atlas
    //
    document.getElementById('toggle-layout').addEventListener('click', 
    function() {
      if ((s.forceatlas2 || {}).isRunning) {
        s.stopForceAtlas2();
        document.getElementById('toggle-layout').innerHTML = 'Animate';
      } else {
        s.startForceAtlas2();
        document.getElementById('toggle-layout').innerHTML = 'Stop';
      }
    });
    
    // reset zoom
    document.getElementById('recenter-camera').addEventListener('click', 
    function() {
      s.cameras[0].goTo({
                x: 0,
                y: 0,
                angle: 0,
                ratio: 1
              });
    });
    
  }
);
</script>

</body>
</html>
